#INFO: **** input file is /tigress/xingz/pydmfet/examples/proj/graphene.py ****
from pydmfet import proj_ao
from pydmfet.qcwrap.pyscf_rks_ao import rks_ao
from pyscf import gto,scf
import numpy as np
from pyscf.tools import molden
from pyscf import lo
from pyscf.lo import iao,orth
from functools import reduce
import math

bas ='6-31G*'
temp = 0.005

mol = gto.Mole()
mol.atom = open('graphene.xyz').read()
mol.basis = bas
mol.charge = 0
mol.build(max_memory = 4000, verbose=4)

_, mo_energy, mo_coeff, mo_occ, irrep_labels, spins = molden.load("graphene_mo.molden")

#mf = scf.RKS(mol)
mf = rks_ao(mol,smear_sigma = temp)
mf.xc = "pbe,pbe"
mf.max_cycle = 100

mf.mo_energy = mo_energy
mf.mo_occ = mo_occ
mf.mo_coeff = mo_coeff

DMguess = mf.make_rdm1()
mf.scf(dm0=DMguess)

'''
with open( 'graphene_mo.molden', 'w' ) as thefile:
    molden.header(mol, thefile)
    molden.orbital_coeff(mol, thefile, mf.mo_coeff,ene=mf.mo_energy,occ=mf.mo_occ)
'''


natoms = mol.natm
impAtom = np.zeros([natoms], dtype=int)
impAtom[11-1] = 1
impAtom[18-1] = 1
impAtom[20-1] = 1


embed = proj_ao.proj_embed(mf,impAtom, Ne_env = 174)
embed.pop_method = 'meta_lowdin'
embed.pm_exponent = 2
embed.make_frozen_orbs(norb = 97)

embed.embedding_potential()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='tigercpu.princeton.edu', release='3.10.0-957.21.2.el7.x86_64', version='#1 SMP Tue Jun 4 15:19:05 EDT 2019', machine='x86_64', processor='x86_64')  Threads 40
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.16.4  scipy 1.4.0.dev0+0f78e0f
Date: Fri Jul  5 00:27:43 2019
PySCF version 1.5
PySCF path  /home/xingz/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 45
[INPUT] num. electrons = 200
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 C     -3.696000000000  -2.133890000000   0.000000000000 AA   -6.984427756392  -4.032467679948   0.000000000000 Bohr
[INPUT]  2 C     -4.928000000000   0.000000000000   0.000000000000 AA   -9.312570341857   0.000000000000   0.000000000000 Bohr
[INPUT]  3 C     -2.464000000000  -2.845180000000   0.000000000000 AA   -4.656285170928  -5.376610975090   0.000000000000 Bohr
[INPUT]  4 C     -1.232000000000  -2.133890000000   0.000000000000 AA   -2.328142585464  -4.032467679948   0.000000000000 Bohr
[INPUT]  5 C     -3.696000000000  -0.711300000000   0.000000000000 AA   -6.984427756392  -1.344162192403   0.000000000000 Bohr
[INPUT]  6 C     -2.464000000000   0.000000000000   0.000000000000 AA   -4.656285170928   0.000000000000   0.000000000000 Bohr
[INPUT]  7 C     -4.928000000000   1.422590000000   0.000000000000 AA   -9.312570341857   2.688305487545   0.000000000000 Bohr
[INPUT]  8 C     -3.696000000000   2.133890000000   0.000000000000 AA   -6.984427756392   4.032467679948   0.000000000000 Bohr
[INPUT]  9 C      0.000000000000  -2.845180000000   0.000000000000 AA    0.000000000000  -5.376610975090   0.000000000000 Bohr
[INPUT] 10 C      1.232000000000  -2.133890000000   0.000000000000 AA    2.328142585464  -4.032467679948   0.000000000000 Bohr
[INPUT] 11 C     -1.232000000000  -0.711300000000   0.000000000000 AA   -2.328142585464  -1.344162192403   0.000000000000 Bohr
[INPUT] 12 C     -2.464000000000   1.422590000000   0.000000000000 AA   -4.656285170928   2.688305487545   0.000000000000 Bohr
[INPUT] 13 C     -1.232000000000   2.133890000000   0.000000000000 AA   -2.328142585464   4.032467679948   0.000000000000 Bohr
[INPUT] 14 C     -3.696000000000   3.556480000000   0.000000000000 AA   -6.984427756392   6.720773167493   0.000000000000 Bohr
[INPUT] 15 C     -2.464000000000   4.267770000000   0.000000000000 AA   -4.656285170928   8.064916462635   0.000000000000 Bohr
[INPUT] 16 C      2.464000000000  -2.845180000000   0.000000000000 AA    4.656285170928  -5.376610975090   0.000000000000 Bohr
[INPUT] 17 C      3.696000000000  -2.133890000000   0.000000000000 AA    6.984427756392  -4.032467679948   0.000000000000 Bohr
[INPUT] 18 C      1.232000000000  -0.711300000000   0.000000000000 AA    2.328142585464  -1.344162192403   0.000000000000 Bohr
[INPUT] 19 C      2.464000000000   0.000000000000   0.000000000000 AA    4.656285170928   0.000000000000   0.000000000000 Bohr
[INPUT] 20 C      0.000000000000   1.422590000000   0.000000000000 AA    0.000000000000   2.688305487545   0.000000000000 Bohr
[INPUT] 21 C      1.232000000000   2.133890000000   0.000000000000 AA    2.328142585464   4.032467679948   0.000000000000 Bohr
[INPUT] 22 C     -1.232000000000   3.556480000000   0.000000000000 AA   -2.328142585464   6.720773167493   0.000000000000 Bohr
[INPUT] 23 C      0.000000000000   4.267770000000   0.000000000000 AA    0.000000000000   8.064916462635   0.000000000000 Bohr
[INPUT] 24 C      3.696000000000  -0.711300000000   0.000000000000 AA    6.984427756392  -1.344162192403   0.000000000000 Bohr
[INPUT] 25 C      4.928000000000   0.000000000000   0.000000000000 AA    9.312570341857   0.000000000000   0.000000000000 Bohr
[INPUT] 26 C      2.464000000000   1.422590000000   0.000000000000 AA    4.656285170928   2.688305487545   0.000000000000 Bohr
[INPUT] 27 C      3.696000000000   2.133890000000   0.000000000000 AA    6.984427756392   4.032467679948   0.000000000000 Bohr
[INPUT] 28 C      1.232000000000   3.556480000000   0.000000000000 AA    2.328142585464   6.720773167493   0.000000000000 Bohr
[INPUT] 29 C      2.464000000000   4.267770000000   0.000000000000 AA    4.656285170928   8.064916462635   0.000000000000 Bohr
[INPUT] 30 C      4.928000000000   1.422590000000   0.000000000000 AA    9.312570341857   2.688305487545   0.000000000000 Bohr
[INPUT] 31 C      3.696000000000   3.556480000000   0.000000000000 AA    6.984427756392   6.720773167493   0.000000000000 Bohr
[INPUT] 32 H     -4.589740000000  -2.649890000000   0.000000000000 AA   -8.673351582961  -5.007566360224   0.000000000000 Bohr
[INPUT] 33 H     -5.821740000000  -0.516000000000   0.000000000000 AA  -11.001494168425  -0.975098680276   0.000000000000 Bohr
[INPUT] 34 H     -2.464000000000  -3.877180000000   0.000000000000 AA   -4.656285170928  -7.326808335641   0.000000000000 Bohr
[INPUT] 35 H     -5.821740000000   1.938590000000   0.000000000000 AA  -11.001494168425   3.663404167821   0.000000000000 Bohr
[INPUT] 36 H      0.000000000000  -3.877180000000   0.000000000000 AA    0.000000000000  -7.326808335641   0.000000000000 Bohr
[INPUT] 37 H     -4.589740000000   4.072480000000   0.000000000000 AA   -8.673351582961   7.695871847769   0.000000000000 Bohr
[INPUT] 38 H     -2.464000000000   5.299770000000   0.000000000000 AA   -4.656285170928  10.015113823186   0.000000000000 Bohr
[INPUT] 39 H      2.464000000000  -3.877180000000   0.000000000000 AA    4.656285170928  -7.326808335641   0.000000000000 Bohr
[INPUT] 40 H      4.589740000000  -2.649890000000   0.000000000000 AA    8.673351582961  -5.007566360224   0.000000000000 Bohr
[INPUT] 41 H      0.000000000000   5.299770000000   0.000000000000 AA    0.000000000000  10.015113823186   0.000000000000 Bohr
[INPUT] 42 H      5.821740000000  -0.516000000000   0.000000000000 AA   11.001494168425  -0.975098680276   0.000000000000 Bohr
[INPUT] 43 H      2.464000000000   5.299770000000   0.000000000000 AA    4.656285170928  10.015113823186   0.000000000000 Bohr
[INPUT] 44 H      5.821740000000   1.938590000000   0.000000000000 AA   11.001494168425   3.663404167821   0.000000000000 Bohr
[INPUT] 45 H      4.589740000000   4.072480000000   0.000000000000 AA    8.673351582961   7.695871847769   0.000000000000 Bohr

nuclear repulsion = 2654.37849633672
number of shells = 214
number of NR pGTOs = 893
number of NR cGTOs = 462
basis = 6-31G*
ecp = {}
CPU time:         4.28
rks_ao.ne_frozen =  0


******** <class 'pydmfet.qcwrap.pyscf_rks_ao.rks_ao'> flags ********
method = rks_ao-RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 100
direct_scf = False
chkfile to save SCF result = /tigress/xingz/pydmfet/examples/proj/tmp7l3xckvw
max_memory 4000 MB (current use 88 MB)
XC functionals = pbe,pbe
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2b519738e9d8>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b519738e950>
Set gradient conv threshold to 3.16228e-05
tot grids = 571298
entropy correction =  -0.013941505395243732
init E= -1188.03511163299
HOMO:  -0.13943960251126555 LUMO:  -0.12571582721217986
Fermi energy:      -0.1346094345
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4487e+00 2.8892e-01 2.6308e-01
 3.3207e-04]
entropy correction =  -0.013972542526748444
cycle= 1 E= -1188.03511081221  delta_E= 8.21e-07  |g|= 0.00152  |ddm|= 0.00297
HOMO:  -0.13945386839883153 LUMO:  -0.12519282479842436
Fermi energy:      -0.1343843473
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4676e+00 2.7450e-01 2.5856e-01
 3.4382e-04]
entropy correction =  -0.013705476379141046
cycle= 2 E= -1188.03504545386  delta_E= 6.54e-05  |g|= 0.0133  |ddm|= 0.0262
HOMO:  -0.13943562511532923 LUMO:  -0.1256740589667597
Fermi energy:      -0.1345770743
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4509e+00 2.8846e-01 2.6127e-01
 3.3458e-04]
entropy correction =  -0.013940228872009996
cycle= 3 E= -1188.03511119345  delta_E= -6.57e-05  |g|= 0.0011  |ddm|= 0.0242
HOMO:  -0.13944556405952357 LUMO:  -0.1256671420650204
Fermi energy:      -0.1345908126
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4506e+00 2.8744e-01 2.6260e-01
 3.3313e-04]
entropy correction =  -0.013945284175979782
cycle= 4 E= -1188.03511164304  delta_E= -4.5e-07  |g|= 0.000206  |ddm|= 0.00247
HOMO:  -0.13944143831423847 LUMO:  -0.12566418176342278
Fermi energy:      -0.1345859595
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4507e+00 2.8753e-01 2.6245e-01
 3.3340e-04]
entropy correction =  -0.013944372706318915
cycle= 5 E= -1188.03511165788  delta_E= -1.48e-08  |g|= 2.52e-05  |ddm|= 0.00032
HOMO:  -0.1394414450120131 LUMO:  -0.12566468520355467
Fermi energy:      -0.1345861388
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4507e+00 2.8755e-01 2.6245e-01
 3.3339e-04]
entropy correction =  -0.013944562362030597
cycle= 6 E= -1188.03511165804  delta_E= -1.66e-10  |g|= 1.35e-05  |ddm|= 2.96e-05
HOMO:  -0.13944048537615633 LUMO:  -0.1256687762977297
Fermi energy:      -0.1345869403
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4505e+00 2.8771e-01 2.6242e-01
 3.3339e-04]
entropy correction =  -0.013946477198573516
Extra cycle  E= -1188.03511165189  delta_E= 6.15e-09  |g|= 0.000124  |ddm|= 0.000261
converged SCF energy = -1188.03511165189


******** <class 'pyscf.lo.pipek.PipekMezey'> flags ********
conv_tol = 1e-06
conv_tol_grad = None
max_cycle = 100
max_stepsize = 0.05
max_iters = 20
kf_interval = 5
kf_trust_region = 5
ah_start_tol = 1000000000.0
ah_start_cycle = 1
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_max_cycle = 40
ah_trust_region = 3
init_guess = atomic
pop_method = meta_lowdin
Set conv_tol_grad to 0.000316228
macro= 1  f(x)= 20.356421457432  delta_f= 20.3564  |g|= 0.536934  1 KF 5 Hx
macro= 2  f(x)= 29.272615083076  delta_f= 8.91619  |g|= 2.51827  4 KF 20 Hx
macro= 3  f(x)= 31.615652088851  delta_f= 2.34304  |g|= 1.37902  4 KF 20 Hx
macro= 4  f(x)= 34.304049175858  delta_f= 2.6884  |g|= 0.729712  4 KF 20 Hx
macro= 5  f(x)= 39.662453776266  delta_f= 5.3584  |g|= 0.801931  4 KF 20 Hx
macro= 6  f(x)= 41.711477206318  delta_f= 2.04902  |g|= 1.0449  4 KF 20 Hx
macro= 7  f(x)= 45.332096758895  delta_f= 3.62062  |g|= 1.38703  4 KF 20 Hx
macro= 8  f(x)= 48.799669775184  delta_f= 3.46757  |g|= 1.42868  4 KF 20 Hx
macro= 9  f(x)= 53.601472900482  delta_f= 4.8018  |g|= 1.22149  4 KF 20 Hx
macro= 10  f(x)= 55.876914381675  delta_f= 2.27544  |g|= 0.887476  4 KF 20 Hx
macro= 11  f(x)= 57.482935572239  delta_f= 1.60602  |g|= 0.614142  4 KF 20 Hx
macro= 12  f(x)= 58.084626550679  delta_f= 0.601691  |g|= 0.516738  4 KF 21 Hx
macro= 13  f(x)= 58.363768743748  delta_f= 0.279142  |g|= 0.0991919  4 KF 24 Hx
macro= 14  f(x)= 58.426698141041  delta_f= 0.0629294  |g|= 0.0307599  3 KF 8 Hx
macro= 15  f(x)= 58.42815653434  delta_f= 0.00145839  |g|= 0.000273354  4 KF 11 Hx
macro= 16  f(x)= 58.428156546547  delta_f= 1.22079e-08  |g|= 8.63582e-05  1 KF 2 Hx
macro X = 16  f(x)= 58.428156546547  |g|= 8.63582e-05  32 intor 57 KF 271 Hx
  sorted Mulliken popupaltion: 1.0 for fully occupied
1.008412e+00 1.008412e+00 1.007672e+00 1.007672e+00 1.006931e+00 
1.006931e+00 1.005912e+00 1.005912e+00 1.005870e+00 1.005870e+00 
1.004117e+00 1.004117e+00 1.001095e+00 1.001095e+00 1.000487e+00 
1.000230e+00 1.000212e+00 1.000212e+00 1.000190e+00 1.000190e+00 
1.000163e+00 1.000155e+00 1.000089e+00 1.000089e+00 1.000062e+00 
1.000062e+00 1.000060e+00 1.000060e+00 1.000040e+00 1.000004e+00 
1.000004e+00 1.000003e+00 1.000000e+00 1.000000e+00 1.000000e+00 
1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 
9.999994e-01 9.999994e-01 9.999920e-01 9.999920e-01 9.999703e-01 
9.999703e-01 9.999649e-01 9.999305e-01 9.999305e-01 9.999254e-01 
9.999254e-01 9.999209e-01 9.999209e-01 9.999200e-01 9.999200e-01 
9.998109e-01 9.998109e-01 9.991851e-01 9.991851e-01 9.991732e-01 
9.991732e-01 9.987357e-01 9.987357e-01 9.985817e-01 9.985817e-01 
9.983886e-01 9.983886e-01 9.983082e-01 9.983082e-01 9.980022e-01 
9.980022e-01 9.978419e-01 9.978396e-01 9.973200e-01 9.957018e-01 
9.957018e-01 9.930441e-01 9.918220e-01 9.917685e-01 9.903029e-01 
9.861937e-01 9.802768e-01 8.841772e-01 8.286204e-01 8.244754e-01 
7.533076e-01 6.751874e-01 4.764271e-01 4.764271e-01 4.355975e-01 
4.355974e-01 4.234922e-01 4.234922e-01 3.927236e-02 1.132097e-03 
1.132097e-03 -7.229382e-05 
87 enviroment orbitals kept frozen.
rks_ao.ne_frozen =  174


******** <class 'pydmfet.qcwrap.pyscf_rks_ao.rks_ao'> flags ********
method = rks_ao-RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = False
chkfile to save SCF result = /tigress/xingz/pydmfet/examples/proj/tmpe5npif_4
max_memory 4000 MB (current use 563 MB)
XC functionals = pbe,pbe
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2b519738e9d8>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b519738e950>
Set gradient conv threshold to 3.16228e-05
tot grids = 571298
init E= -1249.75658840353
HOMO:  -0.13944750096692146 LUMO:  -0.1256280955544913
Fermi energy:      -0.1345771190
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00
 1.4519e+00 2.8619e-01 2.6260e-01 3.3358e-04]
entropy correction =  -0.01392762619600576
cycle= 1 E= -1188.03511128218  delta_E= 61.7  |g|= 0.000963  |ddm|= 14.1
HOMO:  -0.13939726532544874 LUMO:  -0.1259546053322759
Fermi energy:      -0.1346605795
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00
 1.4412e+00 2.9832e-01 2.6117e-01 3.3163e-04]
entropy correction =  -0.014072352756206332
cycle= 2 E= -1188.03508830215  delta_E= 2.3e-05  |g|= 0.00764  |ddm|= 14.1
HOMO:  -0.1394402243969347 LUMO:  -0.1256629817732689
Fermi energy:      -0.1345849237
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00
 1.4507e+00 2.8752e-01 2.6246e-01 3.3349e-04]
entropy correction =  -0.013944084156080765
cycle= 3 E= -1188.03511165214  delta_E= -2.33e-05  |g|= 2.9e-05  |ddm|= 14.1
HOMO:  -0.13944148050969918 LUMO:  -0.12566370675514316
Fermi energy:      -0.1345856882
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00
 1.4507e+00 2.8752e-01 2.6243e-01 3.3342e-04]
entropy correction =  -0.013943535574549805
cycle= 4 E= -1188.03511165028  delta_E= 1.85e-09  |g|= 1.94e-05  |ddm|= 14.1
HOMO:  -0.13944163105224405 LUMO:  -0.125664353000234
Fermi energy:      -0.1345861969
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00
 1.4507e+00 2.8753e-01 2.6245e-01 3.3338e-04]
entropy correction =  -0.013943943277385922
cycle= 5 E= -1188.03511165093  delta_E= -6.42e-10  |g|= 8.74e-06  |ddm|= 14.1
HOMO:  -0.13944062884535302 LUMO:  -0.12566633184821657
Fermi energy:      -0.1345859974
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00
 1.4506e+00 2.8764e-01 2.6241e-01 3.3343e-04]
entropy correction =  -0.013944792554194148
Extra cycle  E= -1188.03511165354  delta_E= -2.61e-09  |g|= 6.64e-05  |ddm|= 14.1
converged SCF energy = -1188.03511165354
<class 'pydmfet.qcwrap.pyscf_rks_ao.rks_ao'> does not have attributes  add_coredm_ext_energy coredm vext_1e ne_frozen
level shift energy: 1.702463784530872e-08
|P_frag + P_bath - P_ref| / N =  2.813226226900693e-07
max(P_frag + P_bath - P_ref) =  1.9933839599028946e-05
