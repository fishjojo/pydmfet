#INFO: **** input file is /tigress/xingz/pydmfet/examples/research/O2-graphene/dmfet/O2-graphene.py ****
from pydmfet import locints, sdmfet,oep,tools
from pydmfet.qcwrap.pyscf_rks_ao import rks_ao
from pyscf import gto, scf, ao2mo
import numpy as np
from pyscf.tools import molden

t0 = tools.time0()

bas ='6-31G*'
temp = 0.005


mol = gto.Mole()
mol.atom = open('O2-graphene.xyz').read()
mol.basis = bas
mol.charge = 0
mol.build(max_memory = 24000, verbose=4)

dm_guess=None
_, _, mo_coeff, mo_occ, _, _ = molden.load("O2-graphene_pbe.molden")
dm_guess = np.dot(mo_coeff*mo_occ, mo_coeff.T)


#mf = scf.UKS(mol)
mf = rks_ao(mol,smear_sigma = temp)
mf.xc = "pbe,pbe"
mf.max_cycle = 50
mf.scf(dm0=dm_guess)

with open( 'MO.molden', 'w' ) as thefile:
    molden.header(mf.mol, thefile)
    molden.orbital_coeff(mf.mol, thefile, mf.mo_coeff,occ = mf.mo_occ, ene = mf.mo_energy)


myInts = locints.LocalIntegrals( mf, range( mol.nao_nr() ), 'meta_lowdin' )
myInts.TI_OK = False

natoms = mol.natm
impAtom = np.zeros([natoms], dtype=int)
for i in range(12):
    impAtom[i] = 1


ghost_frag = 1-impAtom
ghost_env = 1-ghost_frag

mol_frag = gto.Mole()
mol_frag.atom = tools.add_ghost(mol.atom, ghost_frag)
mol_frag.basis = bas
mol_frag.charge = -8
mol_frag.build(max_memory = 24000,verbose = 4)

mol_env = gto.Mole()
mol_env.atom = tools.add_ghost(mol.atom, ghost_env)
mol_env.basis =  bas
mol_env.charge = 8
mol_env.build(max_memory = 24000,verbose = 4)

boundary_atoms = np.zeros([natoms])
boundary_atoms2 = np.zeros([natoms])
boundary_atoms[12:20] = 1
boundary_atoms2[12:20] = -1


Ne_frag = 84
aoslice = mol.aoslice_by_atom()
impurities = np.zeros([mol.nao_nr()], dtype = int)
for i in range(natoms):
    if(impAtom[i] == 1):
        impurities[aoslice[i,2]:aoslice[i,3]] = 1

params = oep.OEPparams(algorithm = 'split', opt_method = 'L-BFGS-B', diffP_tol=1e-3, outer_maxit = 10)
params.options['ftol'] = 1e-10
params.options['gtol'] = 1e-3
params.options['maxiter'] = 100
params.options['svd_thresh'] = 1e-2

umat = None
#umat = np.load("umat.npy")

theDMFET = sdmfet.DMFET( mf, mol_frag, mol_env,myInts,impurities, impAtom, Ne_frag, \
                         boundary_atoms=boundary_atoms, boundary_atoms2=boundary_atoms2,\
                         umat = umat, dim_imp =None, dim_bath=None, dim_big =None, smear_sigma = temp, \
                         oep_params=params,ecw_method='ccsd', mf_method = mf.xc,\
                         use_umat_ao=False, scf_max_cycle = 100)

#umat = theDMFET.embedding_potential()

t1 = tools.timer("total calc time", t0)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='tiger-i25c1n15', release='3.10.0-957.27.2.el7.x86_64', version='#1 SMP Tue Jul 30 11:12:20 EDT 2019', machine='x86_64', processor='x86_64')  Threads 40
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.16.4  scipy 1.4.0.dev0+0f78e0f
Date: Wed Sep 11 00:34:05 2019
PySCF version 1.5
PySCF path  /home/xingz/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 48
[INPUT] num. electrons = 222
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      1.832205000000  -1.057825000000   1.300000000000 AA    3.462365654059  -1.998999537718   2.456643961935 Bohr
[INPUT]  2 O      0.610735000000   1.057825000000   1.300000000000 AA    1.154121884686   1.998999537718   2.456643961935 Bohr
[INPUT]  3 C      1.221470000000   0.705220000000   0.000000000000 AA    2.308243769372   1.332672657566   0.000000000000 Bohr
[INPUT]  4 C      1.221470000000  -0.705220000000   0.000000000000 AA    2.308243769372  -1.332672657566   0.000000000000 Bohr
[INPUT]  5 C      0.000000000000  -1.410430000000   0.000000000000 AA    0.000000000000  -2.665326417870   0.000000000000 Bohr
[INPUT]  6 C     -1.221470000000  -0.705220000000   0.000000000000 AA   -2.308243769372  -1.332672657566   0.000000000000 Bohr
[INPUT]  7 C     -1.221470000000   0.705220000000   0.000000000000 AA   -2.308243769372   1.332672657566   0.000000000000 Bohr
[INPUT]  8 C      0.000000000000   1.410430000000   0.000000000000 AA    0.000000000000   2.665326417870   0.000000000000 Bohr
[INPUT]  9 C      2.442940000000   1.410430000000   0.000000000000 AA    4.616487538745   2.665326417870   0.000000000000 Bohr
[INPUT] 10 C      3.664760000000   0.706140000000   0.000000000000 AA    6.925392712261   1.334411205600   0.000000000000 Bohr
[INPUT] 11 C      3.664760000000  -0.706140000000   0.000000000000 AA    6.925392712261  -1.334411205600   0.000000000000 Bohr
[INPUT] 12 C      2.442940000000  -1.410430000000   0.000000000000 AA    4.616487538745  -2.665326417870   0.000000000000 Bohr
[INPUT] 13 C      2.443910000000  -2.820710000000   0.000000000000 AA    4.618320573086  -5.330369376822   0.000000000000 Bohr
[INPUT] 14 C      0.000000000000  -2.820870000000   0.000000000000 AA    0.000000000000  -5.330671733002   0.000000000000 Bohr
[INPUT] 15 C     -2.442940000000  -1.410430000000   0.000000000000 AA   -4.616487538745  -2.665326417870   0.000000000000 Bohr
[INPUT] 16 C     -2.442940000000   1.410430000000   0.000000000000 AA   -4.616487538745   2.665326417870   0.000000000000 Bohr
[INPUT] 17 C      0.000000000000   2.820870000000   0.000000000000 AA    0.000000000000   5.330671733002   0.000000000000 Bohr
[INPUT] 18 C      2.443910000000   2.820710000000   0.000000000000 AA    4.618320573086   5.330369376822   0.000000000000 Bohr
[INPUT] 19 C      4.887650000000   1.412940000000   0.000000000000 AA    9.236319892730   2.670069630443   0.000000000000 Bohr
[INPUT] 20 C      4.887650000000  -1.412940000000   0.000000000000 AA    9.236319892730  -2.670069630443   0.000000000000 Bohr
[INPUT] 21 C      1.220850000000   3.526840000000   0.000000000000 AA    2.307072139175   6.664761685161   0.000000000000 Bohr
[INPUT] 22 C     -1.220850000000   3.526840000000   0.000000000000 AA   -2.307072139175   6.664761685161   0.000000000000 Bohr
[INPUT] 23 C      3.667460000000   3.526360000000   0.000000000000 AA    6.930494972797   6.663854616621   0.000000000000 Bohr
[INPUT] 24 C      1.220850000000  -3.526840000000   0.000000000000 AA    2.307072139175  -6.664761685161   0.000000000000 Bohr
[INPUT] 25 C     -2.443910000000   2.820710000000   0.000000000000 AA   -4.618320573086   5.330369376822   0.000000000000 Bohr
[INPUT] 26 C      4.881230000000   2.818180000000   0.000000000000 AA    9.224187851011   5.325588369727   0.000000000000 Bohr
[INPUT] 27 C     -1.220850000000  -3.526840000000   0.000000000000 AA   -2.307072139175  -6.664761685161   0.000000000000 Bohr
[INPUT] 28 C     -3.664760000000   0.706140000000   0.000000000000 AA   -6.925392712261   1.334411205600   0.000000000000 Bohr
[INPUT] 29 C      3.667460000000  -3.526360000000   0.000000000000 AA    6.930494972797  -6.663854616621   0.000000000000 Bohr
[INPUT] 30 C      6.096720000000   0.699840000000   0.000000000000 AA   11.521131058158   1.322505931016   0.000000000000 Bohr
[INPUT] 31 C     -2.443910000000  -2.820710000000   0.000000000000 AA   -4.618320573086  -5.330369376822   0.000000000000 Bohr
[INPUT] 32 C     -3.664760000000  -0.706140000000   0.000000000000 AA   -6.925392712261  -1.334411205600   0.000000000000 Bohr
[INPUT] 33 C      4.881230000000  -2.818180000000   0.000000000000 AA    9.224187851011  -5.325588369727   0.000000000000 Bohr
[INPUT] 34 C      6.096720000000  -0.699840000000   0.000000000000 AA   11.521131058158  -1.322505931016   0.000000000000 Bohr
[INPUT] 35 H      5.820580000000   3.360510000000   0.000000000000 AA   10.999302086121   6.350443538862   0.000000000000 Bohr
[INPUT] 36 H      7.044400000000   1.225090000000   0.000000000000 AA   13.311986711886   2.315084577943   0.000000000000 Bohr
[INPUT] 37 H      5.820580000000  -3.360510000000   0.000000000000 AA   10.999302086121  -6.350443538862   0.000000000000 Bohr
[INPUT] 38 H      7.044400000000  -1.225090000000   0.000000000000 AA   13.311986711886  -2.315084577943   0.000000000000 Bohr
[INPUT] 39 H      1.220500000000   4.558840000000   0.000000000000 AA    2.306410735032   8.614959045712   0.000000000000 Bohr
[INPUT] 40 H     -1.220500000000   4.558840000000   0.000000000000 AA   -2.306410735032   8.614959045712   0.000000000000 Bohr
[INPUT] 41 H      3.670060000000   4.558360000000   0.000000000000 AA    6.935408260721   8.614051977172   0.000000000000 Bohr
[INPUT] 42 H      1.220500000000  -4.558840000000   0.000000000000 AA    2.306410735032  -8.614959045712   0.000000000000 Bohr
[INPUT] 43 H     -3.337820000000   3.336400000000   0.000000000000 AA   -6.307565653096   6.304882241999   0.000000000000 Bohr
[INPUT] 44 H     -1.220500000000  -4.558840000000   0.000000000000 AA   -2.306410735032  -8.614959045712   0.000000000000 Bohr
[INPUT] 45 H     -4.558320000000   1.222450000000   0.000000000000 AA   -8.613976388127   2.310095700975   0.000000000000 Bohr
[INPUT] 46 H      3.670060000000  -4.558360000000   0.000000000000 AA    6.935408260721  -8.614051977172   0.000000000000 Bohr
[INPUT] 47 H     -3.337820000000  -3.336400000000   0.000000000000 AA   -6.307565653096  -6.304882241999   0.000000000000 Bohr
[INPUT] 48 H     -4.558320000000  -1.222450000000   0.000000000000 AA   -8.613976388127  -2.310095700975   0.000000000000 Bohr

nuclear repulsion = 3395.56554220199
number of shells = 232
number of NR pGTOs = 974
number of NR cGTOs = 504
basis = 6-31G*
ecp = {}
CPU time:         2.66
rks_ao.ne_frozen =  0


******** <class 'pydmfet.qcwrap.pyscf_rks_ao.rks_ao'> flags ********
method = rks_ao-RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmpkpeoh2jm
max_memory 24000 MB (current use 103 MB)
XC functionals = pbe,pbe
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2b0c35c43488>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b0c35c43400>
Set gradient conv threshold to 3.16228e-05
tot grids = 613724
init E= -1376.45091748539
HOMO:  -0.15583576213718336 LUMO:  -0.11349060221908935
Fermi energy:      -0.1343911426
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9961e+00 1.9729e+00 3.0133e-02 9.0782e-04]
entropy correction =  -0.001682907517832507
cycle= 1 E= -1376.45259780542  delta_E= -0.00168  |g|= 0.00016  |ddm|= 0.000219
HOMO:  -0.15582484204489788 LUMO:  -0.1134860017218658
Fermi energy:      -0.1343843246
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9961e+00 1.9729e+00 3.0146e-02 9.0965e-04]
entropy correction =  -0.00168350788522868
cycle= 2 E= -1376.45259771589  delta_E= 8.95e-08  |g|= 0.000615  |ddm|= 0.00083
HOMO:  -0.1558370400698638 LUMO:  -0.11349314886545964
Fermi energy:      -0.1343931747
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9961e+00 1.9729e+00 3.0136e-02 9.0805e-04]
entropy correction =  -0.0016830431952174051
cycle= 3 E= -1376.45259781093  delta_E= -9.5e-08  |g|= 5.34e-05  |ddm|= 0.000688
HOMO:  -0.15583592315393938 LUMO:  -0.11349207004418646
Fermi energy:      -0.1343921441
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9961e+00 1.9729e+00 3.0136e-02 9.0818e-04]
entropy correction =  -0.0016830333124140183
cycle= 4 E= -1376.45259781175  delta_E= -8.29e-10  |g|= 7.52e-06  |ddm|= 7.16e-05
HOMO:  -0.15583581081004558 LUMO:  -0.11349197855386475
Fermi energy:      -0.1343920185
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9961e+00 1.9729e+00 3.0136e-02 9.0814e-04]
entropy correction =  -0.0016830412369461822
Extra cycle  E= -1376.45259781157  delta_E= 1.86e-10  |g|= 2.51e-05  |ddm|= 4.28e-05
converged SCF energy = -1376.45259781157
#INFO: **** input file is /tigress/xingz/pydmfet/examples/research/O2-graphene/dmfet/O2-graphene.py ****
from pydmfet import locints, sdmfet,oep,tools
from pydmfet.qcwrap.pyscf_rks_ao import rks_ao
from pyscf import gto, scf, ao2mo
import numpy as np
from pyscf.tools import molden

t0 = tools.time0()

bas ='6-31G*'
temp = 0.005


mol = gto.Mole()
mol.atom = open('O2-graphene.xyz').read()
mol.basis = bas
mol.charge = 0
mol.build(max_memory = 24000, verbose=4)

dm_guess=None
_, _, mo_coeff, mo_occ, _, _ = molden.load("O2-graphene_pbe.molden")
dm_guess = np.dot(mo_coeff*mo_occ, mo_coeff.T)


#mf = scf.UKS(mol)
mf = rks_ao(mol,smear_sigma = temp)
mf.xc = "pbe,pbe"
mf.max_cycle = 50
mf.scf(dm0=dm_guess)

with open( 'MO.molden', 'w' ) as thefile:
    molden.header(mf.mol, thefile)
    molden.orbital_coeff(mf.mol, thefile, mf.mo_coeff,occ = mf.mo_occ, ene = mf.mo_energy)


myInts = locints.LocalIntegrals( mf, range( mol.nao_nr() ), 'meta_lowdin' )
myInts.TI_OK = False

natoms = mol.natm
impAtom = np.zeros([natoms], dtype=int)
for i in range(12):
    impAtom[i] = 1


ghost_frag = 1-impAtom
ghost_env = 1-ghost_frag

mol_frag = gto.Mole()
mol_frag.atom = tools.add_ghost(mol.atom, ghost_frag)
mol_frag.basis = bas
mol_frag.charge = -8
mol_frag.build(max_memory = 24000,verbose = 4)

mol_env = gto.Mole()
mol_env.atom = tools.add_ghost(mol.atom, ghost_env)
mol_env.basis =  bas
mol_env.charge = 8
mol_env.build(max_memory = 24000,verbose = 4)

boundary_atoms = np.zeros([natoms])
boundary_atoms2 = np.zeros([natoms])
boundary_atoms[12:20] = 1
boundary_atoms2[12:20] = -1


Ne_frag = 84
aoslice = mol.aoslice_by_atom()
impurities = np.zeros([mol.nao_nr()], dtype = int)
for i in range(natoms):
    if(impAtom[i] == 1):
        impurities[aoslice[i,2]:aoslice[i,3]] = 1

params = oep.OEPparams(algorithm = 'split', opt_method = 'L-BFGS-B', diffP_tol=1e-3, outer_maxit = 10)
params.options['ftol'] = 1e-10
params.options['gtol'] = 1e-3
params.options['maxiter'] = 100
params.options['svd_thresh'] = 1e-2

umat = None
#umat = np.load("umat.npy")

theDMFET = sdmfet.DMFET( mf, mol_frag, mol_env,myInts,impurities, impAtom, Ne_frag, \
                         boundary_atoms=boundary_atoms, boundary_atoms2=boundary_atoms2,\
                         umat = umat, dim_imp =None, dim_bath=None, dim_big =None, smear_sigma = temp, \
                         oep_params=params,ecw_method='ccsd', mf_method = mf.xc,\
                         use_umat_ao=False, scf_max_cycle = 100)

#umat = theDMFET.embedding_potential()

t1 = tools.timer("total calc time", t0)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='tiger-i25c1n15', release='3.10.0-957.27.2.el7.x86_64', version='#1 SMP Tue Jul 30 11:12:20 EDT 2019', machine='x86_64', processor='x86_64')  Threads 40
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.16.4  scipy 1.4.0.dev0+0f78e0f
Date: Wed Sep 11 00:36:55 2019
PySCF version 1.5
PySCF path  /home/xingz/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 48
[INPUT] num. electrons = 84
[INPUT] charge = -8
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      1.832205000000  -1.057825000000   1.300000000000 AA    3.462365654059  -1.998999537718   2.456643961935 Bohr
[INPUT]  2 O      0.610735000000   1.057825000000   1.300000000000 AA    1.154121884686   1.998999537718   2.456643961935 Bohr
[INPUT]  3 C      1.221470000000   0.705220000000   0.000000000000 AA    2.308243769372   1.332672657566   0.000000000000 Bohr
[INPUT]  4 C      1.221470000000  -0.705220000000   0.000000000000 AA    2.308243769372  -1.332672657566   0.000000000000 Bohr
[INPUT]  5 C      0.000000000000  -1.410430000000   0.000000000000 AA    0.000000000000  -2.665326417870   0.000000000000 Bohr
[INPUT]  6 C     -1.221470000000  -0.705220000000   0.000000000000 AA   -2.308243769372  -1.332672657566   0.000000000000 Bohr
[INPUT]  7 C     -1.221470000000   0.705220000000   0.000000000000 AA   -2.308243769372   1.332672657566   0.000000000000 Bohr
[INPUT]  8 C      0.000000000000   1.410430000000   0.000000000000 AA    0.000000000000   2.665326417870   0.000000000000 Bohr
[INPUT]  9 C      2.442940000000   1.410430000000   0.000000000000 AA    4.616487538745   2.665326417870   0.000000000000 Bohr
[INPUT] 10 C      3.664760000000   0.706140000000   0.000000000000 AA    6.925392712261   1.334411205600   0.000000000000 Bohr
[INPUT] 11 C      3.664760000000  -0.706140000000   0.000000000000 AA    6.925392712261  -1.334411205600   0.000000000000 Bohr
[INPUT] 12 C      2.442940000000  -1.410430000000   0.000000000000 AA    4.616487538745  -2.665326417870   0.000000000000 Bohr
[INPUT] 13 GHOST-C   2.443910000000  -2.820710000000   0.000000000000 AA    4.618320573086  -5.330369376822   0.000000000000 Bohr
[INPUT] 14 GHOST-C   0.000000000000  -2.820870000000   0.000000000000 AA    0.000000000000  -5.330671733002   0.000000000000 Bohr
[INPUT] 15 GHOST-C  -2.442940000000  -1.410430000000   0.000000000000 AA   -4.616487538745  -2.665326417870   0.000000000000 Bohr
[INPUT] 16 GHOST-C  -2.442940000000   1.410430000000   0.000000000000 AA   -4.616487538745   2.665326417870   0.000000000000 Bohr
[INPUT] 17 GHOST-C   0.000000000000   2.820870000000   0.000000000000 AA    0.000000000000   5.330671733002   0.000000000000 Bohr
[INPUT] 18 GHOST-C   2.443910000000   2.820710000000   0.000000000000 AA    4.618320573086   5.330369376822   0.000000000000 Bohr
[INPUT] 19 GHOST-C   4.887650000000   1.412940000000   0.000000000000 AA    9.236319892730   2.670069630443   0.000000000000 Bohr
[INPUT] 20 GHOST-C   4.887650000000  -1.412940000000   0.000000000000 AA    9.236319892730  -2.670069630443   0.000000000000 Bohr
[INPUT] 21 GHOST-C   1.220850000000   3.526840000000   0.000000000000 AA    2.307072139175   6.664761685161   0.000000000000 Bohr
[INPUT] 22 GHOST-C  -1.220850000000   3.526840000000   0.000000000000 AA   -2.307072139175   6.664761685161   0.000000000000 Bohr
[INPUT] 23 GHOST-C   3.667460000000   3.526360000000   0.000000000000 AA    6.930494972797   6.663854616621   0.000000000000 Bohr
[INPUT] 24 GHOST-C   1.220850000000  -3.526840000000   0.000000000000 AA    2.307072139175  -6.664761685161   0.000000000000 Bohr
[INPUT] 25 GHOST-C  -2.443910000000   2.820710000000   0.000000000000 AA   -4.618320573086   5.330369376822   0.000000000000 Bohr
[INPUT] 26 GHOST-C   4.881230000000   2.818180000000   0.000000000000 AA    9.224187851011   5.325588369727   0.000000000000 Bohr
[INPUT] 27 GHOST-C  -1.220850000000  -3.526840000000   0.000000000000 AA   -2.307072139175  -6.664761685161   0.000000000000 Bohr
[INPUT] 28 GHOST-C  -3.664760000000   0.706140000000   0.000000000000 AA   -6.925392712261   1.334411205600   0.000000000000 Bohr
[INPUT] 29 GHOST-C   3.667460000000  -3.526360000000   0.000000000000 AA    6.930494972797  -6.663854616621   0.000000000000 Bohr
[INPUT] 30 GHOST-C   6.096720000000   0.699840000000   0.000000000000 AA   11.521131058158   1.322505931016   0.000000000000 Bohr
[INPUT] 31 GHOST-C  -2.443910000000  -2.820710000000   0.000000000000 AA   -4.618320573086  -5.330369376822   0.000000000000 Bohr
[INPUT] 32 GHOST-C  -3.664760000000  -0.706140000000   0.000000000000 AA   -6.925392712261  -1.334411205600   0.000000000000 Bohr
[INPUT] 33 GHOST-C   4.881230000000  -2.818180000000   0.000000000000 AA    9.224187851011  -5.325588369727   0.000000000000 Bohr
[INPUT] 34 GHOST-C   6.096720000000  -0.699840000000   0.000000000000 AA   11.521131058158  -1.322505931016   0.000000000000 Bohr
[INPUT] 35 GHOST-H   5.820580000000   3.360510000000   0.000000000000 AA   10.999302086121   6.350443538862   0.000000000000 Bohr
[INPUT] 36 GHOST-H   7.044400000000   1.225090000000   0.000000000000 AA   13.311986711886   2.315084577943   0.000000000000 Bohr
[INPUT] 37 GHOST-H   5.820580000000  -3.360510000000   0.000000000000 AA   10.999302086121  -6.350443538862   0.000000000000 Bohr
[INPUT] 38 GHOST-H   7.044400000000  -1.225090000000   0.000000000000 AA   13.311986711886  -2.315084577943   0.000000000000 Bohr
[INPUT] 39 GHOST-H   1.220500000000   4.558840000000   0.000000000000 AA    2.306410735032   8.614959045712   0.000000000000 Bohr
[INPUT] 40 GHOST-H  -1.220500000000   4.558840000000   0.000000000000 AA   -2.306410735032   8.614959045712   0.000000000000 Bohr
[INPUT] 41 GHOST-H   3.670060000000   4.558360000000   0.000000000000 AA    6.935408260721   8.614051977172   0.000000000000 Bohr
[INPUT] 42 GHOST-H   1.220500000000  -4.558840000000   0.000000000000 AA    2.306410735032  -8.614959045712   0.000000000000 Bohr
[INPUT] 43 GHOST-H  -3.337820000000   3.336400000000   0.000000000000 AA   -6.307565653096   6.304882241999   0.000000000000 Bohr
[INPUT] 44 GHOST-H  -1.220500000000  -4.558840000000   0.000000000000 AA   -2.306410735032  -8.614959045712   0.000000000000 Bohr
[INPUT] 45 GHOST-H  -4.558320000000   1.222450000000   0.000000000000 AA   -8.613976388127   2.310095700975   0.000000000000 Bohr
[INPUT] 46 GHOST-H   3.670060000000  -4.558360000000   0.000000000000 AA    6.935408260721  -8.614051977172   0.000000000000 Bohr
[INPUT] 47 GHOST-H  -3.337820000000  -3.336400000000   0.000000000000 AA   -6.307565653096  -6.304882241999   0.000000000000 Bohr
[INPUT] 48 GHOST-H  -4.558320000000  -1.222450000000   0.000000000000 AA   -8.613976388127  -2.310095700975   0.000000000000 Bohr

nuclear repulsion = 591.281067693055
number of shells = 232
number of NR pGTOs = 974
number of NR cGTOs = 504
basis = 6-31G*
ecp = {}
CPU time:      4261.67
#INFO: **** input file is /tigress/xingz/pydmfet/examples/research/O2-graphene/dmfet/O2-graphene.py ****
from pydmfet import locints, sdmfet,oep,tools
from pydmfet.qcwrap.pyscf_rks_ao import rks_ao
from pyscf import gto, scf, ao2mo
import numpy as np
from pyscf.tools import molden

t0 = tools.time0()

bas ='6-31G*'
temp = 0.005


mol = gto.Mole()
mol.atom = open('O2-graphene.xyz').read()
mol.basis = bas
mol.charge = 0
mol.build(max_memory = 24000, verbose=4)

dm_guess=None
_, _, mo_coeff, mo_occ, _, _ = molden.load("O2-graphene_pbe.molden")
dm_guess = np.dot(mo_coeff*mo_occ, mo_coeff.T)


#mf = scf.UKS(mol)
mf = rks_ao(mol,smear_sigma = temp)
mf.xc = "pbe,pbe"
mf.max_cycle = 50
mf.scf(dm0=dm_guess)

with open( 'MO.molden', 'w' ) as thefile:
    molden.header(mf.mol, thefile)
    molden.orbital_coeff(mf.mol, thefile, mf.mo_coeff,occ = mf.mo_occ, ene = mf.mo_energy)


myInts = locints.LocalIntegrals( mf, range( mol.nao_nr() ), 'meta_lowdin' )
myInts.TI_OK = False

natoms = mol.natm
impAtom = np.zeros([natoms], dtype=int)
for i in range(12):
    impAtom[i] = 1


ghost_frag = 1-impAtom
ghost_env = 1-ghost_frag

mol_frag = gto.Mole()
mol_frag.atom = tools.add_ghost(mol.atom, ghost_frag)
mol_frag.basis = bas
mol_frag.charge = -8
mol_frag.build(max_memory = 24000,verbose = 4)

mol_env = gto.Mole()
mol_env.atom = tools.add_ghost(mol.atom, ghost_env)
mol_env.basis =  bas
mol_env.charge = 8
mol_env.build(max_memory = 24000,verbose = 4)

boundary_atoms = np.zeros([natoms])
boundary_atoms2 = np.zeros([natoms])
boundary_atoms[12:20] = 1
boundary_atoms2[12:20] = -1


Ne_frag = 84
aoslice = mol.aoslice_by_atom()
impurities = np.zeros([mol.nao_nr()], dtype = int)
for i in range(natoms):
    if(impAtom[i] == 1):
        impurities[aoslice[i,2]:aoslice[i,3]] = 1

params = oep.OEPparams(algorithm = 'split', opt_method = 'L-BFGS-B', diffP_tol=1e-3, outer_maxit = 10)
params.options['ftol'] = 1e-10
params.options['gtol'] = 1e-3
params.options['maxiter'] = 100
params.options['svd_thresh'] = 1e-2

umat = None
#umat = np.load("umat.npy")

theDMFET = sdmfet.DMFET( mf, mol_frag, mol_env,myInts,impurities, impAtom, Ne_frag, \
                         boundary_atoms=boundary_atoms, boundary_atoms2=boundary_atoms2,\
                         umat = umat, dim_imp =None, dim_bath=None, dim_big =None, smear_sigma = temp, \
                         oep_params=params,ecw_method='ccsd', mf_method = mf.xc,\
                         use_umat_ao=False, scf_max_cycle = 100)

#umat = theDMFET.embedding_potential()

t1 = tools.timer("total calc time", t0)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='tiger-i25c1n15', release='3.10.0-957.27.2.el7.x86_64', version='#1 SMP Tue Jul 30 11:12:20 EDT 2019', machine='x86_64', processor='x86_64')  Threads 40
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.16.4  scipy 1.4.0.dev0+0f78e0f
Date: Wed Sep 11 00:36:55 2019
PySCF version 1.5
PySCF path  /home/xingz/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 48
[INPUT] num. electrons = 138
[INPUT] charge = 8
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 GHOST-O   1.832205000000  -1.057825000000   1.300000000000 AA    3.462365654059  -1.998999537718   2.456643961935 Bohr
[INPUT]  2 GHOST-O   0.610735000000   1.057825000000   1.300000000000 AA    1.154121884686   1.998999537718   2.456643961935 Bohr
[INPUT]  3 GHOST-C   1.221470000000   0.705220000000   0.000000000000 AA    2.308243769372   1.332672657566   0.000000000000 Bohr
[INPUT]  4 GHOST-C   1.221470000000  -0.705220000000   0.000000000000 AA    2.308243769372  -1.332672657566   0.000000000000 Bohr
[INPUT]  5 GHOST-C   0.000000000000  -1.410430000000   0.000000000000 AA    0.000000000000  -2.665326417870   0.000000000000 Bohr
[INPUT]  6 GHOST-C  -1.221470000000  -0.705220000000   0.000000000000 AA   -2.308243769372  -1.332672657566   0.000000000000 Bohr
[INPUT]  7 GHOST-C  -1.221470000000   0.705220000000   0.000000000000 AA   -2.308243769372   1.332672657566   0.000000000000 Bohr
[INPUT]  8 GHOST-C   0.000000000000   1.410430000000   0.000000000000 AA    0.000000000000   2.665326417870   0.000000000000 Bohr
[INPUT]  9 GHOST-C   2.442940000000   1.410430000000   0.000000000000 AA    4.616487538745   2.665326417870   0.000000000000 Bohr
[INPUT] 10 GHOST-C   3.664760000000   0.706140000000   0.000000000000 AA    6.925392712261   1.334411205600   0.000000000000 Bohr
[INPUT] 11 GHOST-C   3.664760000000  -0.706140000000   0.000000000000 AA    6.925392712261  -1.334411205600   0.000000000000 Bohr
[INPUT] 12 GHOST-C   2.442940000000  -1.410430000000   0.000000000000 AA    4.616487538745  -2.665326417870   0.000000000000 Bohr
[INPUT] 13 C      2.443910000000  -2.820710000000   0.000000000000 AA    4.618320573086  -5.330369376822   0.000000000000 Bohr
[INPUT] 14 C      0.000000000000  -2.820870000000   0.000000000000 AA    0.000000000000  -5.330671733002   0.000000000000 Bohr
[INPUT] 15 C     -2.442940000000  -1.410430000000   0.000000000000 AA   -4.616487538745  -2.665326417870   0.000000000000 Bohr
[INPUT] 16 C     -2.442940000000   1.410430000000   0.000000000000 AA   -4.616487538745   2.665326417870   0.000000000000 Bohr
[INPUT] 17 C      0.000000000000   2.820870000000   0.000000000000 AA    0.000000000000   5.330671733002   0.000000000000 Bohr
[INPUT] 18 C      2.443910000000   2.820710000000   0.000000000000 AA    4.618320573086   5.330369376822   0.000000000000 Bohr
[INPUT] 19 C      4.887650000000   1.412940000000   0.000000000000 AA    9.236319892730   2.670069630443   0.000000000000 Bohr
[INPUT] 20 C      4.887650000000  -1.412940000000   0.000000000000 AA    9.236319892730  -2.670069630443   0.000000000000 Bohr
[INPUT] 21 C      1.220850000000   3.526840000000   0.000000000000 AA    2.307072139175   6.664761685161   0.000000000000 Bohr
[INPUT] 22 C     -1.220850000000   3.526840000000   0.000000000000 AA   -2.307072139175   6.664761685161   0.000000000000 Bohr
[INPUT] 23 C      3.667460000000   3.526360000000   0.000000000000 AA    6.930494972797   6.663854616621   0.000000000000 Bohr
[INPUT] 24 C      1.220850000000  -3.526840000000   0.000000000000 AA    2.307072139175  -6.664761685161   0.000000000000 Bohr
[INPUT] 25 C     -2.443910000000   2.820710000000   0.000000000000 AA   -4.618320573086   5.330369376822   0.000000000000 Bohr
[INPUT] 26 C      4.881230000000   2.818180000000   0.000000000000 AA    9.224187851011   5.325588369727   0.000000000000 Bohr
[INPUT] 27 C     -1.220850000000  -3.526840000000   0.000000000000 AA   -2.307072139175  -6.664761685161   0.000000000000 Bohr
[INPUT] 28 C     -3.664760000000   0.706140000000   0.000000000000 AA   -6.925392712261   1.334411205600   0.000000000000 Bohr
[INPUT] 29 C      3.667460000000  -3.526360000000   0.000000000000 AA    6.930494972797  -6.663854616621   0.000000000000 Bohr
[INPUT] 30 C      6.096720000000   0.699840000000   0.000000000000 AA   11.521131058158   1.322505931016   0.000000000000 Bohr
[INPUT] 31 C     -2.443910000000  -2.820710000000   0.000000000000 AA   -4.618320573086  -5.330369376822   0.000000000000 Bohr
[INPUT] 32 C     -3.664760000000  -0.706140000000   0.000000000000 AA   -6.925392712261  -1.334411205600   0.000000000000 Bohr
[INPUT] 33 C      4.881230000000  -2.818180000000   0.000000000000 AA    9.224187851011  -5.325588369727   0.000000000000 Bohr
[INPUT] 34 C      6.096720000000  -0.699840000000   0.000000000000 AA   11.521131058158  -1.322505931016   0.000000000000 Bohr
[INPUT] 35 H      5.820580000000   3.360510000000   0.000000000000 AA   10.999302086121   6.350443538862   0.000000000000 Bohr
[INPUT] 36 H      7.044400000000   1.225090000000   0.000000000000 AA   13.311986711886   2.315084577943   0.000000000000 Bohr
[INPUT] 37 H      5.820580000000  -3.360510000000   0.000000000000 AA   10.999302086121  -6.350443538862   0.000000000000 Bohr
[INPUT] 38 H      7.044400000000  -1.225090000000   0.000000000000 AA   13.311986711886  -2.315084577943   0.000000000000 Bohr
[INPUT] 39 H      1.220500000000   4.558840000000   0.000000000000 AA    2.306410735032   8.614959045712   0.000000000000 Bohr
[INPUT] 40 H     -1.220500000000   4.558840000000   0.000000000000 AA   -2.306410735032   8.614959045712   0.000000000000 Bohr
[INPUT] 41 H      3.670060000000   4.558360000000   0.000000000000 AA    6.935408260721   8.614051977172   0.000000000000 Bohr
[INPUT] 42 H      1.220500000000  -4.558840000000   0.000000000000 AA    2.306410735032  -8.614959045712   0.000000000000 Bohr
[INPUT] 43 H     -3.337820000000   3.336400000000   0.000000000000 AA   -6.307565653096   6.304882241999   0.000000000000 Bohr
[INPUT] 44 H     -1.220500000000  -4.558840000000   0.000000000000 AA   -2.306410735032  -8.614959045712   0.000000000000 Bohr
[INPUT] 45 H     -4.558320000000   1.222450000000   0.000000000000 AA   -8.613976388127   2.310095700975   0.000000000000 Bohr
[INPUT] 46 H      3.670060000000  -4.558360000000   0.000000000000 AA    6.935408260721  -8.614051977172   0.000000000000 Bohr
[INPUT] 47 H     -3.337820000000  -3.336400000000   0.000000000000 AA   -6.307565653096  -6.304882241999   0.000000000000 Bohr
[INPUT] 48 H     -4.558320000000  -1.222450000000   0.000000000000 AA   -8.613976388127  -2.310095700975   0.000000000000 Bohr

nuclear repulsion = 1312.53642654964
number of shells = 232
number of NR pGTOs = 974
number of NR cGTOs = 504
basis = 6-31G*
ecp = {}
CPU time:      4262.14
HOMO:  -0.15583534989926429 LUMO:  -0.11349143207072285
mo_energy:
[-18.7653 -18.7653  -9.9504  -9.9501  -9.9474  -9.9473  -9.9061  -9.9057
  -9.904   -9.9039  -9.9036  -9.9035  -9.9034  -9.9032  -9.9032  -9.9031
  -9.9026  -9.9021  -9.902   -9.9019  -9.8991  -9.897   -9.8965  -9.8962
  -9.8949  -9.8946  -9.8946  -9.8945  -9.8945  -9.8933  -9.8932  -9.8932
  -9.8929  -9.8928  -1.0092  -0.9751  -0.8141  -0.809   -0.7856  -0.7791
  -0.7649  -0.739   -0.7302  -0.7279  -0.7172  -0.6949  -0.686   -0.6762
  -0.6658  -0.6497  -0.6447  -0.6297  -0.6026  -0.5983  -0.5846  -0.58
  -0.5722  -0.5654  -0.5326  -0.5242  -0.5219  -0.5139  -0.4998  -0.4932
  -0.4874  -0.4608  -0.4561  -0.441   -0.4394  -0.431   -0.4268  -0.4265
  -0.4102  -0.4012  -0.3965  -0.3919  -0.3854  -0.3835  -0.3815  -0.3803
  -0.377   -0.375   -0.3657  -0.3572  -0.3568  -0.3534  -0.3447  -0.341
  -0.3348  -0.3316  -0.329   -0.3203  -0.3161  -0.3135  -0.3053  -0.2947
  -0.2939  -0.2918  -0.2813  -0.2785  -0.273   -0.2666  -0.2475  -0.2357
  -0.2271  -0.2233  -0.2007  -0.1992  -0.1903  -0.1655  -0.1558  -0.1135
  -0.0959  -0.0701  -0.0407  -0.0331]
fermi energy:  -0.1343915874870259
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9961e+00 1.9729e+00 3.0135e-02 9.0828e-04]
  occ_imp
9.822744e-01 1.035108e+00 9.522354e-01 9.510291e-01 9.431278e-01 
1.078154e+00 1.104701e+00 1.105070e+00 1.516667e+00 3.178762e-01 
2.333385e-01 2.086554e-01 1.808568e+00 9.117198e-02 1.921530e+00 
1.924059e+00 6.128162e-02 5.300411e-02 1.971741e+00 2.275678e-02 
1.977652e+00 1.979543e+00 1.720003e-02 1.984210e+00 1.448346e-02 
1.366182e-02 1.308273e-02 1.284184e-02 1.055745e-02 1.991689e+00 
1.992395e+00 6.099976e-03 5.326288e-03 1.995368e+00 1.996809e+00 
2.621326e-03 2.413090e-03 1.997981e+00 1.998051e+00 1.998480e+00 
1.244018e-03 1.998949e+00 9.761762e-04 8.575932e-04 5.776894e-04 
5.174752e-04 1.999490e+00 4.581807e-04 1.999679e+00 2.948704e-04 
2.251376e-04 1.999793e+00 1.433380e-04 1.171618e-04 8.437609e-05 
8.096964e-05 6.029097e-05 5.833892e-05 5.487436e-05 4.801801e-05 
3.190937e-05 3.117593e-05 2.651426e-05 2.419840e-05 1.547276e-05 
1.384091e-05 1.112236e-05 1.083077e-05 1.999990e+00 1.999991e+00 
1.999991e+00 1.999991e+00 8.400137e-06 1.999993e+00 6.878222e-06 
1.999994e+00 1.999994e+00 5.150677e-06 4.871934e-06 1.999995e+00 
3.315961e-06 2.765869e-06 2.172191e-06 1.752543e-06 1.999998e+00 
1.644854e-06 1.999998e+00 1.175742e-06 2.952438e-07 2.000000e+00 
2.435120e-07 2.000000e+00 2.176234e-07 1.663266e-07 1.521704e-07 
8.546507e-08 5.912420e-08 4.008519e-08 3.189025e-08 2.233111e-08 
9.885495e-09 9.029666e-09 4.207906e-09 3.661498e-09 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 
0.000000e+00 0.000000e+00 0.000000e+00 
  occ_bath
1.017726e+00 9.648921e-01 1.047765e+00 1.048971e+00 1.056872e+00 
9.218463e-01 8.952986e-01 8.949305e-01 4.833331e-01 1.682124e+00 
1.766662e+00 1.791345e+00 1.914320e-01 1.908828e+00 7.847022e-02 
7.594140e-02 1.938718e+00 1.946996e+00 2.825864e-02 1.977243e+00 
2.234792e-02 2.045721e-02 1.982800e+00 1.579004e-02 1.985517e+00 
1.986338e+00 1.986917e+00 1.987158e+00 1.989443e+00 8.310792e-03 
7.605427e-03 1.993900e+00 1.994674e+00 4.632446e-03 3.191301e-03 
1.997379e+00 1.997587e+00 2.019052e-03 1.949297e-03 1.519855e-03 
1.998756e+00 1.050935e-03 1.999024e+00 1.999142e+00 1.999422e+00 
1.999483e+00 5.096514e-04 1.999542e+00 3.212442e-04 1.999705e+00 
1.999775e+00 2.065256e-04 1.999857e+00 1.999883e+00 1.999916e+00 
1.999919e+00 1.999940e+00 1.999942e+00 1.999945e+00 1.999952e+00 
1.999968e+00 1.999969e+00 1.999973e+00 1.999976e+00 1.999985e+00 
1.999986e+00 1.999989e+00 1.999989e+00 9.808181e-06 9.138875e-06 
9.098726e-06 8.776675e-06 1.999992e+00 7.412454e-06 1.999993e+00 
6.493234e-06 5.738112e-06 1.999995e+00 1.999995e+00 4.864883e-06 
1.999997e+00 1.999997e+00 1.999998e+00 1.999998e+00 1.657316e-06 
1.999998e+00 1.611646e-06 1.999999e+00 2.000000e+00 2.580006e-07 
2.000000e+00 2.371577e-07 2.000000e+00 2.000000e+00 2.000000e+00 
2.000000e+00 2.000000e+00 2.000000e+00 2.000000e+00 2.000000e+00 
2.000000e+00 2.000000e+00 2.000000e+00 2.000000e+00 
check orthogonality:
norm:  9.27588109123683e-10
max:  3.079875868228221e-10
Ne_frag_loc =  76.0665907826143
Ne_env_loc =  145.93340921738576
dimension of subspace: imp, bath
92 103
Ne_frag, Ne_env, Ne_core
84 114 24
|diffP| =  1.5327753146923708e-15
P_imp idem: 3.6263201242636485
P_bath idem: 3.674023024631351
|umat| =  0.0
time of coreJK_sub : 441.373  (cpu),  11.066  (wall) 
time of LocalIntegrals.tei_sub : 2598.549  (cpu),  69.653  (wall) 
time of libgen.ops.build_subops : 3043.137  (cpu),  80.800  (wall) 
Set gradient conv threshold to 3.16228e-05
tot grids = 613724
No. of dropped grids =  125366
time of vxc construction : 222.299  (cpu),  16.938  (wall) 
init E= -3801.00461092981
HOMO: -0.15583503085674044 LUMO: -0.11349138557439822
mo_energy:
[-18.7653 -18.7653  -9.9504  -9.9501  -9.9474  -9.9473  -9.906   -9.9056
  -9.904   -9.9039  -9.9035  -9.9035  -9.9034  -9.9032  -9.9032  -9.903
  -9.9026  -9.902   -9.9019  -9.9019  -9.895   -9.8945  -1.037   -1.0266
  -1.0091  -0.975   -0.9433  -0.9259  -0.8689  -0.8159  -0.7918  -0.7905
  -0.7776  -0.7553  -0.7243  -0.722   -0.7084  -0.7014  -0.6923  -0.6692
  -0.6617  -0.625   -0.6212  -0.6097  -0.6042  -0.5927  -0.5781  -0.5457
  -0.5392  -0.5284  -0.5174  -0.5132  -0.5026  -0.4914  -0.4636  -0.46
  -0.4576  -0.4488  -0.4476  -0.4392  -0.421   -0.4124  -0.4034  -0.4024
  -0.3986  -0.3932  -0.3888  -0.3846  -0.3798  -0.3771  -0.3755  -0.3663
  -0.3601  -0.3578  -0.3566  -0.3521  -0.3436  -0.3391  -0.3331  -0.3245
  -0.3211  -0.3162  -0.3057  -0.3011  -0.2943  -0.2929  -0.2834  -0.28
  -0.273   -0.2667  -0.2475  -0.2358  -0.2271  -0.2233  -0.2007  -0.1992
  -0.1903  -0.1655  -0.1558  -0.1135  -0.0959  -0.0701  -0.0407   0.0351]
e_fermi =  -0.13439139973894124
[2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    1.996 1.973 0.03 ]
time of vxc construction : 149.536  (cpu),  12.673  (wall) 
entropy correction =  -0.001683050002827343
cycle= 1 E= -3801.00629414583  delta_E= -0.00168  |g|= 4.19e-05  |ddm|= 0.000514
HOMO: -0.15583853737529177 LUMO: -0.11349436265522085
mo_energy:
[-18.765 -18.765  -9.95   -9.95   -9.947  -9.947  -9.906  -9.906  -9.904
  -9.904  -9.904  -9.904  -9.903  -9.903  -9.903  -9.903  -9.903  -9.902
  -9.902  -9.902  -9.895  -9.895  -1.037  -1.027  -1.009  -0.975  -0.943
  -0.926  -0.869  -0.816  -0.792  -0.791  -0.778  -0.755  -0.724  -0.722
  -0.708  -0.701  -0.692  -0.669  -0.662  -0.625  -0.621  -0.61   -0.604
  -0.593  -0.578  -0.546  -0.539  -0.528  -0.517  -0.513  -0.503  -0.491
  -0.464  -0.46   -0.458  -0.449  -0.448  -0.439  -0.421  -0.412  -0.403
  -0.402  -0.399  -0.393  -0.389  -0.385  -0.38   -0.377  -0.375  -0.366
  -0.36   -0.358  -0.357  -0.352  -0.344  -0.339  -0.333  -0.325  -0.321
  -0.316  -0.306  -0.301  -0.294  -0.293  -0.283  -0.28   -0.273  -0.267
  -0.248  -0.236  -0.227  -0.223  -0.201  -0.199  -0.19   -0.166  -0.156
  -0.113  -0.096  -0.07   -0.041   0.035]
e_fermi =  -0.13439442126284148
[2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    1.996 1.973 0.03 ]
time of vxc construction : 152.006  (cpu),  12.661  (wall) 
entropy correction =  -0.0016830307606164796
cycle= 2 E= -3801.00629413657  delta_E= 9.26e-09  |g|= 0.000155  |ddm|= 0.000395
HOMO: -0.15583640179846275 LUMO: -0.11349264152612833
mo_energy:
[-18.765 -18.765  -9.95   -9.95   -9.947  -9.947  -9.906  -9.906  -9.904
  -9.904  -9.904  -9.903  -9.903  -9.903  -9.903  -9.903  -9.903  -9.902
  -9.902  -9.902  -9.895  -9.895  -1.037  -1.027  -1.009  -0.975  -0.943
  -0.926  -0.869  -0.816  -0.792  -0.791  -0.778  -0.755  -0.724  -0.722
  -0.708  -0.701  -0.692  -0.669  -0.662  -0.625  -0.621  -0.61   -0.604
  -0.593  -0.578  -0.546  -0.539  -0.528  -0.517  -0.513  -0.503  -0.491
  -0.464  -0.46   -0.458  -0.449  -0.448  -0.439  -0.421  -0.412  -0.403
  -0.402  -0.399  -0.393  -0.389  -0.385  -0.38   -0.377  -0.375  -0.366
  -0.36   -0.358  -0.357  -0.352  -0.344  -0.339  -0.333  -0.325  -0.321
  -0.316  -0.306  -0.301  -0.294  -0.293  -0.283  -0.28   -0.273  -0.267
  -0.248  -0.236  -0.227  -0.223  -0.201  -0.199  -0.19   -0.166  -0.156
  -0.113  -0.096  -0.07   -0.041   0.035]
e_fermi =  -0.13439264968136413
[2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    1.996 1.973 0.03 ]
time of vxc construction : 149.195  (cpu),  13.074  (wall) 
entropy correction =  -0.0016830494507375704
cycle= 3 E= -3801.00629414643  delta_E= -9.86e-09  |g|= 1.29e-05  |ddm|= 0.000335
HOMO: -0.1558361441145493 LUMO: -0.1134924363624062
mo_energy:
[-18.765 -18.765  -9.95   -9.95   -9.947  -9.947  -9.906  -9.906  -9.904
  -9.904  -9.904  -9.903  -9.903  -9.903  -9.903  -9.903  -9.903  -9.902
  -9.902  -9.902  -9.895  -9.895  -1.037  -1.027  -1.009  -0.975  -0.943
  -0.926  -0.869  -0.816  -0.792  -0.791  -0.778  -0.755  -0.724  -0.722
  -0.708  -0.701  -0.692  -0.669  -0.662  -0.625  -0.621  -0.61   -0.604
  -0.593  -0.578  -0.546  -0.539  -0.528  -0.517  -0.513  -0.503  -0.491
  -0.464  -0.46   -0.458  -0.449  -0.448  -0.439  -0.421  -0.412  -0.403
  -0.402  -0.399  -0.393  -0.389  -0.385  -0.38   -0.377  -0.375  -0.366
  -0.36   -0.358  -0.357  -0.352  -0.344  -0.339  -0.333  -0.325  -0.321
  -0.316  -0.306  -0.301  -0.294  -0.293  -0.283  -0.28   -0.273  -0.267
  -0.248  -0.236  -0.227  -0.223  -0.201  -0.199  -0.19   -0.166  -0.156
  -0.113  -0.096  -0.07   -0.041   0.035]
e_fermi =  -0.13439244138799236
[2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    1.996 1.973 0.03 ]
time of vxc construction : 150.084  (cpu),  13.415  (wall) 
entropy correction =  -0.0016830510106004908
cycle= 4 E= -3801.0062941465  delta_E= -6.87e-11  |g|= 3.96e-06  |ddm|= 3.17e-05
HOMO: -0.1558367409593818 LUMO: -0.11349289864316824
mo_energy:
[-18.765 -18.765  -9.95   -9.95   -9.947  -9.947  -9.906  -9.906  -9.904
  -9.904  -9.904  -9.903  -9.903  -9.903  -9.903  -9.903  -9.903  -9.902
  -9.902  -9.902  -9.895  -9.895  -1.037  -1.027  -1.009  -0.975  -0.943
  -0.926  -0.869  -0.816  -0.792  -0.791  -0.778  -0.755  -0.724  -0.722
  -0.708  -0.701  -0.692  -0.669  -0.662  -0.625  -0.621  -0.61   -0.604
  -0.593  -0.578  -0.546  -0.539  -0.528  -0.517  -0.513  -0.503  -0.491
  -0.464  -0.46   -0.458  -0.449  -0.448  -0.439  -0.421  -0.412  -0.403
  -0.402  -0.399  -0.393  -0.389  -0.385  -0.38   -0.377  -0.375  -0.366
  -0.36   -0.358  -0.357  -0.352  -0.344  -0.339  -0.333  -0.325  -0.321
  -0.316  -0.306  -0.301  -0.294  -0.293  -0.283  -0.28   -0.273  -0.267
  -0.248  -0.236  -0.227  -0.223  -0.201  -0.199  -0.19   -0.166  -0.156
  -0.113  -0.096  -0.07   -0.041   0.035]
e_fermi =  -0.1343929286585834
[2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.    2.
 2.    1.996 1.973 0.03 ]
time of vxc construction : 151.271  (cpu),  13.184  (wall) 
entropy correction =  -0.001683043044156257
Extra cycle  E= -3801.00629414643  delta_E= 7.23e-11  |g|= 1.36e-05  |ddm|= 3.28e-05
time of vxc construction : 153.287  (cpu),  12.505  (wall) 
entropy correction =  -0.001683043044156257
max(P_tot - P_ref) =  0.00011236128084577909
|P_tot - P_ref| =  0.0005058078801643682
total scf energy = -1376.45258870116 
-3801.00629414643, -971.011836756715, 3395.56554220199
time of total calc time : 9365.811  (cpu),  369.765  (wall) 
