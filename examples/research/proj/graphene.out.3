#INFO: **** input file is /tigress/xingz/pydmfet/examples/proj/graphene.py ****
from pydmfet import proj_ao
from pydmfet.qcwrap.pyscf_rks_ao import rks_ao
from pyscf import gto,scf
import numpy as np
from pyscf.tools import molden
from pyscf import lo
from pyscf.lo import iao,orth
from functools import reduce
import math

bas ='6-31G*'
temp = 0.005

mol = gto.Mole()
mol.atom = open('graphene.xyz').read()
mol.basis = bas
mol.charge = 0
mol.build(max_memory = 4000, verbose=4)

_, mo_energy, mo_coeff, mo_occ, irrep_labels, spins = molden.load("graphene_mo.molden")

#mf = scf.RKS(mol)
mf = rks_ao(mol,smear_sigma = temp)
mf.xc = "pbe,pbe"
mf.max_cycle = 100

mf.mo_energy = mo_energy
mf.mo_occ = mo_occ
mf.mo_coeff = mo_coeff

DMguess = mf.make_rdm1()
mf.scf(dm0=DMguess)

'''
with open( 'graphene_mo.molden', 'w' ) as thefile:
    molden.header(mol, thefile)
    molden.orbital_coeff(mol, thefile, mf.mo_coeff,ene=mf.mo_energy,occ=mf.mo_occ)
'''


natoms = mol.natm
impAtom = np.zeros([natoms], dtype=int)
impAtom[11-1] = 1
impAtom[18-1] = 1
impAtom[20-1] = 1


embed = proj_ao.proj_embed(mf,impAtom, Ne_env = 176)
embed.pop_method = 'meta_lowdin'
embed.pm_exponent = 2
embed.make_frozen_orbs(norb = 97)

embed.embedding_potential()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='tigercpu.princeton.edu', release='3.10.0-957.21.2.el7.x86_64', version='#1 SMP Tue Jun 4 15:19:05 EDT 2019', machine='x86_64', processor='x86_64')  Threads 40
Python 3.7.0 (default, Jun 28 2018, 13:15:42) 
[GCC 7.2.0]
numpy 1.16.4  scipy 1.4.0.dev0+0f78e0f
Date: Fri Jul  5 02:41:29 2019
PySCF version 1.5
PySCF path  /home/xingz/.local/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 45
[INPUT] num. electrons = 200
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 C     -3.696000000000  -2.133890000000   0.000000000000 AA   -6.984427756392  -4.032467679948   0.000000000000 Bohr
[INPUT]  2 C     -4.928000000000   0.000000000000   0.000000000000 AA   -9.312570341857   0.000000000000   0.000000000000 Bohr
[INPUT]  3 C     -2.464000000000  -2.845180000000   0.000000000000 AA   -4.656285170928  -5.376610975090   0.000000000000 Bohr
[INPUT]  4 C     -1.232000000000  -2.133890000000   0.000000000000 AA   -2.328142585464  -4.032467679948   0.000000000000 Bohr
[INPUT]  5 C     -3.696000000000  -0.711300000000   0.000000000000 AA   -6.984427756392  -1.344162192403   0.000000000000 Bohr
[INPUT]  6 C     -2.464000000000   0.000000000000   0.000000000000 AA   -4.656285170928   0.000000000000   0.000000000000 Bohr
[INPUT]  7 C     -4.928000000000   1.422590000000   0.000000000000 AA   -9.312570341857   2.688305487545   0.000000000000 Bohr
[INPUT]  8 C     -3.696000000000   2.133890000000   0.000000000000 AA   -6.984427756392   4.032467679948   0.000000000000 Bohr
[INPUT]  9 C      0.000000000000  -2.845180000000   0.000000000000 AA    0.000000000000  -5.376610975090   0.000000000000 Bohr
[INPUT] 10 C      1.232000000000  -2.133890000000   0.000000000000 AA    2.328142585464  -4.032467679948   0.000000000000 Bohr
[INPUT] 11 C     -1.232000000000  -0.711300000000   0.000000000000 AA   -2.328142585464  -1.344162192403   0.000000000000 Bohr
[INPUT] 12 C     -2.464000000000   1.422590000000   0.000000000000 AA   -4.656285170928   2.688305487545   0.000000000000 Bohr
[INPUT] 13 C     -1.232000000000   2.133890000000   0.000000000000 AA   -2.328142585464   4.032467679948   0.000000000000 Bohr
[INPUT] 14 C     -3.696000000000   3.556480000000   0.000000000000 AA   -6.984427756392   6.720773167493   0.000000000000 Bohr
[INPUT] 15 C     -2.464000000000   4.267770000000   0.000000000000 AA   -4.656285170928   8.064916462635   0.000000000000 Bohr
[INPUT] 16 C      2.464000000000  -2.845180000000   0.000000000000 AA    4.656285170928  -5.376610975090   0.000000000000 Bohr
[INPUT] 17 C      3.696000000000  -2.133890000000   0.000000000000 AA    6.984427756392  -4.032467679948   0.000000000000 Bohr
[INPUT] 18 C      1.232000000000  -0.711300000000   0.000000000000 AA    2.328142585464  -1.344162192403   0.000000000000 Bohr
[INPUT] 19 C      2.464000000000   0.000000000000   0.000000000000 AA    4.656285170928   0.000000000000   0.000000000000 Bohr
[INPUT] 20 C      0.000000000000   1.422590000000   0.000000000000 AA    0.000000000000   2.688305487545   0.000000000000 Bohr
[INPUT] 21 C      1.232000000000   2.133890000000   0.000000000000 AA    2.328142585464   4.032467679948   0.000000000000 Bohr
[INPUT] 22 C     -1.232000000000   3.556480000000   0.000000000000 AA   -2.328142585464   6.720773167493   0.000000000000 Bohr
[INPUT] 23 C      0.000000000000   4.267770000000   0.000000000000 AA    0.000000000000   8.064916462635   0.000000000000 Bohr
[INPUT] 24 C      3.696000000000  -0.711300000000   0.000000000000 AA    6.984427756392  -1.344162192403   0.000000000000 Bohr
[INPUT] 25 C      4.928000000000   0.000000000000   0.000000000000 AA    9.312570341857   0.000000000000   0.000000000000 Bohr
[INPUT] 26 C      2.464000000000   1.422590000000   0.000000000000 AA    4.656285170928   2.688305487545   0.000000000000 Bohr
[INPUT] 27 C      3.696000000000   2.133890000000   0.000000000000 AA    6.984427756392   4.032467679948   0.000000000000 Bohr
[INPUT] 28 C      1.232000000000   3.556480000000   0.000000000000 AA    2.328142585464   6.720773167493   0.000000000000 Bohr
[INPUT] 29 C      2.464000000000   4.267770000000   0.000000000000 AA    4.656285170928   8.064916462635   0.000000000000 Bohr
[INPUT] 30 C      4.928000000000   1.422590000000   0.000000000000 AA    9.312570341857   2.688305487545   0.000000000000 Bohr
[INPUT] 31 C      3.696000000000   3.556480000000   0.000000000000 AA    6.984427756392   6.720773167493   0.000000000000 Bohr
[INPUT] 32 H     -4.589740000000  -2.649890000000   0.000000000000 AA   -8.673351582961  -5.007566360224   0.000000000000 Bohr
[INPUT] 33 H     -5.821740000000  -0.516000000000   0.000000000000 AA  -11.001494168425  -0.975098680276   0.000000000000 Bohr
[INPUT] 34 H     -2.464000000000  -3.877180000000   0.000000000000 AA   -4.656285170928  -7.326808335641   0.000000000000 Bohr
[INPUT] 35 H     -5.821740000000   1.938590000000   0.000000000000 AA  -11.001494168425   3.663404167821   0.000000000000 Bohr
[INPUT] 36 H      0.000000000000  -3.877180000000   0.000000000000 AA    0.000000000000  -7.326808335641   0.000000000000 Bohr
[INPUT] 37 H     -4.589740000000   4.072480000000   0.000000000000 AA   -8.673351582961   7.695871847769   0.000000000000 Bohr
[INPUT] 38 H     -2.464000000000   5.299770000000   0.000000000000 AA   -4.656285170928  10.015113823186   0.000000000000 Bohr
[INPUT] 39 H      2.464000000000  -3.877180000000   0.000000000000 AA    4.656285170928  -7.326808335641   0.000000000000 Bohr
[INPUT] 40 H      4.589740000000  -2.649890000000   0.000000000000 AA    8.673351582961  -5.007566360224   0.000000000000 Bohr
[INPUT] 41 H      0.000000000000   5.299770000000   0.000000000000 AA    0.000000000000  10.015113823186   0.000000000000 Bohr
[INPUT] 42 H      5.821740000000  -0.516000000000   0.000000000000 AA   11.001494168425  -0.975098680276   0.000000000000 Bohr
[INPUT] 43 H      2.464000000000   5.299770000000   0.000000000000 AA    4.656285170928  10.015113823186   0.000000000000 Bohr
[INPUT] 44 H      5.821740000000   1.938590000000   0.000000000000 AA   11.001494168425   3.663404167821   0.000000000000 Bohr
[INPUT] 45 H      4.589740000000   4.072480000000   0.000000000000 AA    8.673351582961   7.695871847769   0.000000000000 Bohr

nuclear repulsion = 2654.37849633672
number of shells = 214
number of NR pGTOs = 893
number of NR cGTOs = 462
basis = 6-31G*
ecp = {}
CPU time:         4.26
rks_ao.ne_frozen =  0


******** <class 'pydmfet.qcwrap.pyscf_rks_ao.rks_ao'> flags ********
method = rks_ao-RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 100
direct_scf = False
chkfile to save SCF result = /tigress/xingz/pydmfet/examples/proj/tmp_qwp_xiv
max_memory 4000 MB (current use 79 MB)
XC functionals = pbe,pbe
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2af3cc62c9d8>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2af3cc62c950>
Set gradient conv threshold to 3.16228e-05
tot grids = 571298
entropy correction =  -0.013941505395243732
init E= -1188.03511163299
HOMO:  -0.13943960251126816 LUMO:  -0.12571582721219032
Fermi energy:      -0.1346094345
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4487e+00 2.8892e-01 2.6308e-01
 3.3207e-04]
entropy correction =  -0.013972542526748885
cycle= 1 E= -1188.03511081221  delta_E= 8.21e-07  |g|= 0.00152  |ddm|= 0.00297
HOMO:  -0.13945386839884313 LUMO:  -0.12519282479840332
Fermi energy:      -0.1343843473
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4676e+00 2.7450e-01 2.5856e-01
 3.4382e-04]
entropy correction =  -0.013705476379135422
cycle= 2 E= -1188.03504545386  delta_E= 6.54e-05  |g|= 0.0133  |ddm|= 0.0262
HOMO:  -0.13943562511533433 LUMO:  -0.12567405896675266
Fermi energy:      -0.1345770743
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4509e+00 2.8846e-01 2.6127e-01
 3.3458e-04]
entropy correction =  -0.01394022887200502
cycle= 3 E= -1188.03511119345  delta_E= -6.57e-05  |g|= 0.0011  |ddm|= 0.0242
HOMO:  -0.13944556405952588 LUMO:  -0.12566714206501894
Fermi energy:      -0.1345908126
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4506e+00 2.8744e-01 2.6260e-01
 3.3313e-04]
entropy correction =  -0.013945284175977115
cycle= 4 E= -1188.03511164304  delta_E= -4.5e-07  |g|= 0.000206  |ddm|= 0.00247
HOMO:  -0.13944143831424616 LUMO:  -0.1256641817634248
Fermi energy:      -0.1345859595
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4507e+00 2.8753e-01 2.6245e-01
 3.3340e-04]
entropy correction =  -0.013944372706317033
cycle= 5 E= -1188.03511165788  delta_E= -1.48e-08  |g|= 2.52e-05  |ddm|= 0.00032
HOMO:  -0.1394414450120227 LUMO:  -0.12566468520356225
Fermi energy:      -0.1345861388
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4507e+00 2.8755e-01 2.6245e-01
 3.3339e-04]
entropy correction =  -0.013944562362030375
cycle= 6 E= -1188.03511165805  delta_E= -1.68e-10  |g|= 1.35e-05  |ddm|= 2.96e-05
HOMO:  -0.1394404853761245 LUMO:  -0.12566877629772755
Fermi energy:      -0.1345869403
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 1.9999e+00 1.9991e+00 1.4505e+00 2.8771e-01 2.6242e-01
 3.3339e-04]
entropy correction =  -0.01394647719858462
Extra cycle  E= -1188.03511165189  delta_E= 6.16e-09  |g|= 0.000124  |ddm|= 0.000261
converged SCF energy = -1188.03511165189


******** <class 'pyscf.lo.pipek.PipekMezey'> flags ********
conv_tol = 1e-06
conv_tol_grad = None
max_cycle = 100
max_stepsize = 0.05
max_iters = 20
kf_interval = 5
kf_trust_region = 5
ah_start_tol = 1000000000.0
ah_start_cycle = 1
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_max_cycle = 40
ah_trust_region = 3
init_guess = atomic
pop_method = meta_lowdin
Set conv_tol_grad to 0.000316228
macro= 1  f(x)= 20.356428662366  delta_f= 20.3564  |g|= 0.536935  1 KF 5 Hx
macro= 2  f(x)= 29.27222055043  delta_f= 8.91579  |g|= 2.51774  4 KF 20 Hx
macro= 3  f(x)= 31.613719975781  delta_f= 2.3415  |g|= 1.38045  4 KF 20 Hx
macro= 4  f(x)= 34.303931073626  delta_f= 2.69021  |g|= 0.729868  4 KF 20 Hx
macro= 5  f(x)= 39.657806677072  delta_f= 5.35388  |g|= 0.802574  4 KF 20 Hx
macro= 6  f(x)= 41.857663669709  delta_f= 2.19986  |g|= 1.06716  4 KF 20 Hx
macro= 7  f(x)= 44.592731825257  delta_f= 2.73507  |g|= 1.33858  4 KF 20 Hx
macro= 8  f(x)= 48.463297410052  delta_f= 3.87057  |g|= 1.4922  4 KF 20 Hx
macro= 9  f(x)= 53.196392636675  delta_f= 4.7331  |g|= 1.13293  4 KF 20 Hx
macro= 10  f(x)= 55.607530522195  delta_f= 2.41114  |g|= 0.990747  4 KF 20 Hx
macro= 11  f(x)= 56.764165899766  delta_f= 1.15664  |g|= 0.668914  3 KF 20 Hx
macro= 12  f(x)= 57.87177042024  delta_f= 1.1076  |g|= 0.603012  4 KF 21 Hx
macro= 13  f(x)= 58.22240542102  delta_f= 0.350635  |g|= 0.142976  4 KF 23 Hx
macro= 14  f(x)= 58.244815477975  delta_f= 0.0224101  |g|= 0.025904  3 KF 8 Hx
macro= 15  f(x)= 58.245174567329  delta_f= 0.000359089  |g|= 0.000348493  3 KF 10 Hx
macro= 16  f(x)= 58.245174567332  delta_f= 2.95586e-12  |g|= 3.75496e-05  1 KF 1 Hx
macro X = 16  f(x)= 58.245174567332  |g|= 3.75496e-05  32 intor 55 KF 268 Hx
  sorted Mulliken popupaltion: 1.0 for fully occupied
1.008412e+00 1.008412e+00 1.007672e+00 1.007672e+00 1.006931e+00 
1.006931e+00 1.005912e+00 1.005912e+00 1.005870e+00 1.005870e+00 
1.004117e+00 1.004117e+00 1.001095e+00 1.001095e+00 1.000487e+00 
1.000230e+00 1.000212e+00 1.000212e+00 1.000190e+00 1.000190e+00 
1.000163e+00 1.000155e+00 1.000089e+00 1.000089e+00 1.000062e+00 
1.000062e+00 1.000060e+00 1.000060e+00 1.000040e+00 1.000004e+00 
1.000004e+00 1.000003e+00 1.000000e+00 1.000000e+00 1.000000e+00 
1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 1.000000e+00 
9.999994e-01 9.999994e-01 9.999920e-01 9.999920e-01 9.999703e-01 
9.999703e-01 9.999649e-01 9.999305e-01 9.999305e-01 9.999254e-01 
9.999254e-01 9.999209e-01 9.999209e-01 9.999200e-01 9.999200e-01 
9.998109e-01 9.998109e-01 9.995008e-01 9.991851e-01 9.991851e-01 
9.991732e-01 9.991732e-01 9.987357e-01 9.987357e-01 9.985817e-01 
9.985817e-01 9.983886e-01 9.983886e-01 9.983564e-01 9.983082e-01 
9.983082e-01 9.980022e-01 9.980022e-01 9.975295e-01 9.973200e-01 
9.957018e-01 9.957018e-01 9.945508e-01 9.944584e-01 9.909242e-01 
9.859364e-01 9.813735e-01 9.789581e-01 8.843380e-01 7.535424e-01 
6.764952e-01 6.588938e-01 4.764272e-01 4.764271e-01 4.355975e-01 
4.355974e-01 4.234923e-01 4.234922e-01 3.927231e-02 1.132097e-03 
1.132097e-03 -7.229382e-05 
88 enviroment orbitals kept frozen.
rks_ao.ne_frozen =  176


******** <class 'pydmfet.qcwrap.pyscf_rks_ao.rks_ao'> flags ********
method = rks_ao-RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = False
chkfile to save SCF result = /tigress/xingz/pydmfet/examples/proj/tmpkmh273fh
max_memory 4000 MB (current use 520 MB)
XC functionals = pbe,pbe
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2af3cc62c9d8>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2af3cc62c950>
Set gradient conv threshold to 3.16228e-05
tot grids = 571298
init E= -1249.75658870004
HOMO:  -0.13944749978109472 LUMO:  -0.12562809447822768
Fermi energy:      -0.1345771180
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00 1.4519e+00
 2.8619e-01 2.6260e-01 3.3358e-04]
entropy correction =  -0.013927626397056745
cycle= 1 E= -1188.03511128057  delta_E= 61.7  |g|= 0.000956  |ddm|= 14.2
HOMO:  -0.13939751949790746 LUMO:  -0.12595249898656924
Fermi energy:      -0.1346597469
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00 1.4412e+00
 2.9826e-01 2.6114e-01 3.3167e-04]
entropy correction =  -0.01407115804829578
cycle= 2 E= -1188.03508885923  delta_E= 2.24e-05  |g|= 0.00754  |ddm|= 14.2
HOMO:  -0.13944025958900536 LUMO:  -0.12566331857806348
Fermi energy:      -0.1345851486
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00 1.4506e+00
 2.8753e-01 2.6247e-01 3.3348e-04]
entropy correction =  -0.013944298494581054
cycle= 3 E= -1188.03511164638  delta_E= -2.28e-05  |g|= 3.01e-05  |ddm|= 14.2
HOMO:  -0.13944136326903234 LUMO:  -0.12566340768525097
Fermi energy:      -0.1345854478
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00 1.4507e+00
 2.8752e-01 2.6242e-01 3.3343e-04]
entropy correction =  -0.013943395080177024
cycle= 4 E= -1188.03511164814  delta_E= -1.76e-09  |g|= 2.32e-05  |ddm|= 14.2
HOMO:  -0.1394416338131371 LUMO:  -0.12566431055657193
Fermi energy:      -0.1345861701
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00 1.4507e+00
 2.8753e-01 2.6245e-01 3.3338e-04]
entropy correction =  -0.013943909982276547
cycle= 5 E= -1188.03511164774  delta_E= 4.03e-10  |g|= 8.73e-06  |ddm|= 14.2
HOMO:  -0.13944064451168936 LUMO:  -0.1256664242987917
Fermi energy:      -0.1345860740
[2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00 2.0000e+00
 2.0000e+00 2.0000e+00 2.0000e+00 1.9999e+00 1.9991e+00 1.4506e+00
 2.8764e-01 2.6241e-01 3.3343e-04]
entropy correction =  -0.013944861980774263
Extra cycle  E= -1188.03511164665  delta_E= 1.09e-09  |g|= 6.7e-05  |ddm|= 14.2
converged SCF energy = -1188.03511164665
<class 'pydmfet.qcwrap.pyscf_rks_ao.rks_ao'> does not have attributes  ne_frozen coredm add_coredm_ext_energy vext_1e
level shift energy: 1.698529794591508e-08
|P_frag + P_bath - P_ref| / N =  2.738307260197512e-07
max(P_frag + P_bath - P_ref) =  1.98800733948179e-05
